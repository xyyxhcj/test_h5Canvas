<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>快速排序</title>
</head>
<body>
<canvas height="820" id="canvas1" style="background:white;" width="800"></canvas>
<script>
    // 动画延时
    const DELAY = 100;
    // 生成数组长度
    const ARR_LENGTH = 10;
    // 保存排序记录
    const STATUS_ARR = [];
    const RESULT_DATA = {
        // 待排序数组
        arr: [],
    };

    function draw(canvas, data) {
        let context = canvas.getContext('2d');
        let maxHeight = canvas.getAttribute('height');
        let width = canvas.getAttribute('width');
        let w = width / data.arr.length;
        context.clearRect(0, 0, 800, 820);
        for (let i = 0; i < data.arr.length; i++) {
            if (data.insertedIndex.indexOf(i) !== -1) {
                context.fillStyle = 'orange';
            } else if (i >= data.margeIndexStart && i < data.margeIndexEnd) {
                context.fillStyle = 'lightGray';
            } else {
                context.fillStyle = 'blue';
            }
            context.fillRect(i * w, maxHeight / 2 - data.arr[i], w - 1, data.arr[i]);
        }
        if (data.tempArr) {
            for (let i = 0; i < data.tempArr.length; i++) {
                if (data.compared.indexOf(i) !== -1) {
                    context.fillStyle = 'white';
                } else if (data.comparingIndex.indexOf(i) !== -1) {
                    context.fillStyle = 'pink';
                } else if (i >= data.margeIndexStart && i < data.margeIndexMiddle) {
                    context.fillStyle = 'Aqua';
                } else if (i >= data.margeIndexMiddle && i < data.margeIndexEnd) {
                    context.fillStyle = 'LightCyan';
                } else {
                    context.fillStyle = 'white';
                }
                context.fillRect(i * w, maxHeight - data.tempArr[i], w - 1, data.tempArr[i]);
            }
        }
    }

    function quickSort(arr, start, length) {
        if (start >= length - 1) {
            return;
        }
        let sign = partition(arr, start, length);
        quickSort(arr, start, sign);
        quickSort(arr, sign + 1, length);
    }

    function partition(arr, start, length) {
        let sign = start;
        for (let i = start + 1; i < length; i++) {
            if (arr[i] <= arr[start] && i !== sign) {
                if (i !== sign + 1) {
                    [arr[i], arr[sign + 1]] = [arr[sign + 1], arr[i]];
                }
                sign++;
            }
        }
        if (start !== sign) {
            [arr[start], arr[sign]] = [arr[sign], arr[start]];
        }
        return sign;
    }

    function run(id) {
        let canvas = document.getElementById(id);
        if (!canvas) {
            return false;
        }
        // 生成随机数组
        for (let i = 0; i < ARR_LENGTH; i++) {
            RESULT_DATA.arr.push(Math.floor(Math.random() * 400 + 1));
        }
        console.log(RESULT_DATA.arr);
        quickSort(RESULT_DATA.arr, 0, RESULT_DATA.arr.length);
        console.log(RESULT_DATA.arr);
        /* let i = 0;
         setInterval(() => {
             if (i < STATUS_ARR.length) {
                 draw(canvas, STATUS_ARR[i]);
                 i++;
             }
         }, DELAY);*/
    }

    run('canvas1');
</script>
</body>
</html>